name: Dynamic Test Batch (20x)

on:
  workflow_dispatch:
    inputs:
      message:
        description: "Message to print"
        required: true
        default: "Hello from GitHub Actions!"
      include_extra_step:
        description: "Include the extra step?"
        required: true
        default: "false"
        type: boolean

jobs:
  test:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # 6 hours
    strategy:
      matrix:
        worker: [1,2,3,4,5,6,7,8,9,10,
                 11,12,13,14,15,16,17,18,19,20]
      # For sequential: uncomment next line
      # max-parallel: 1
    steps:
      - uses: actions/checkout@v4

      - name: Identify worker
        run: echo "‚ñ∂Ô∏è Worker ${{ matrix.worker }} starting"

      - name: Print input message
        run: echo "üì¢ ${{ github.event.inputs.message }}"

      - name: Conditional step
        if: ${{ github.event.inputs.include_extra_step == 'true' }}
        run: echo "‚úÖ Extra step was included!"

      - name: Hold for ~6 hours
        run: sleep $((6*60*60))  # 6 hours = 21600 seconds
